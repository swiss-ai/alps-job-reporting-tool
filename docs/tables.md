# Tables Documentation

## Introduction

This documentation provides a comprehensive explanation of the structure and purpose of the tables generated by the ALPS Job Reporting Tool. These tables are designed to capture and log various system metrics, including GPU performance, CPU utilization, and other hardware-related data, during the execution of SLURM jobs.

The goal of this documentation is to help users and developers understand the meaning of each column in the tables, the source of the data, and how these metrics can be used for performance analysis, debugging, and reporting.

**Key Features of the Tables**:
- **GPU Table**: Captures detailed telemetry data from NVIDIA GPUs using the Data Center GPU Manager (DCGM) API, including metrics such as temperature, power usage, memory utilization, and NVLink throughput.
- **General Table**: Captures other data as for example, CPU temperature, usage statistics, network, I/O. 

Each table is structured to provide a timestamped snapshot of the system's state, enabling users to analyze trends, identify bottlenecks, and optimize resource usage.

By understanding the columns and their meanings, users can effectively interpret the data and leverage it for performance monitoring and reporting.

## GPU Table

This document provides an explanation of the columns in the GPU data table and their corresponding meanings. The fields are derived from NVIDIA's Data Center GPU Manager (DCGM) API. Below is the detailed description for each column.

### Column Descriptions

| **Column Name** | **DCGM Field ID** | **Description** |
|------------------|-------------------|------------------|
| `#Entity`        | -                 | Identifier for the entity (e.g., GPU, NVSwitch) being monitored. |
| `MMTMP`          | 140               | Memory temperature of the GPU. |
| `TMPTR`          | 150               | Device temperature of the GPU. |
| `POWER`          | 155               | Current power usage of the GPU in watts. |
| `POWINST`        | 157               | Instantaneous power usage of the GPU in watts. |
| `PSTAT`          | 190               | Performance state (0-100, where 0 is best). |
| `FANSP`          | 191               | Fan speed as a percentage. (This value seems always N/A.) |
| `TXTPT`          | 200               | PCIe Tx utilization information. (This value seems always N/A.) |
| `RXTPT`          | 201               | PCIe Rx utilization information. (This value seems always N/A.) |
| `GPUTL`          | 203               | GPU utilization as a percentage. |
| `MCUTL`          | 204               | Memory controller utilization as a percentage. |
| `ECUTL`          | 206               | Encoder utilization as a percentage. |
| `DCUTL`          | 207               | Decoder utilization as a percentage. |
| `FBUSP`          | 254               | Percentage of frame buffer memory used. |
| `VIUTL`          | 504               | Utilization values for vGPUs running on the device. |
| `TMP01`          | 858               | NVSwitch current temperature. |
| `SWTX`           | 861               | NVSwitch transmitted throughput in bytes/second. |
| `SWRX`           | 862               | NVSwitch received throughput in bytes/second. |
| `GRACT`          | 1001              | GPU utilization as a percentage. |
| `SMACT`          | 1002              | Memory utilization as the ratio of cycles an SM has at least one warp assigned. |
| `SMOCC`          | 1003              | Ratio of number of warps resident on an SM. |
| `TENSO`          | 1004              | SM utilization as the ratio of cycles any tensor pipe is active. |
| `DRAMA`          | 1005              | Ratio of cycles the device memory interface is active (sending or receiving data). |
| `PCITX`          | 1009              | PCIe transmitted throughput in bytes/second. |
| `PCIRX`          | 1010              | PCIe received throughput in bytes/second. |
| `NVLTX`          | 1011              | NVLink transmitted throughput in bytes/second. |
| `NVLRX`          | 1012              | NVLink received throughput in bytes/second. |
| `NVL0T`          | 1040              | NVLink lane 0 transmitted throughput in bytes/second. |
| `NVL0R`          | 1041              | NVLink lane 0 received throughput in bytes/second. |
| `NVL1T`          | 1042              | NVLink lane 1 transmitted throughput in bytes/second. |
| `NVL1R`          | 1043              | NVLink lane 1 received throughput in bytes/second. |
| `NVL2T`          | 1044              | NVLink lane 2 transmitted throughput in bytes/second. |
| `NVL2R`          | 1045              | NVLink lane 2 received throughput in bytes/second. |
| `NVL3T`          | 1046              | NVLink lane 3 transmitted throughput in bytes/second. |
| `NVL3R`          | 1047              | NVLink lane 3 received throughput in bytes/second. |


### Notes
- The DCGM Field IDs correspond to the definitions in the [NVIDIA DCGM API documentation](https://docs.nvidia.com/datacenter/dcgm/latest/dcgm-api/dcgm-api-field-ids.html).
- The descriptions provide a high-level overview of each metric's purpose and significance.
- Units (e.g., watts, megabytes, percentage) are explicitly stated to avoid ambiguity.

For further details, refer to the [NVIDIA DCGM documentation](https://docs.nvidia.com/datacenter/dcgm/latest/index.html).


## General Table

This document provides a detailed explanation of the structure and purpose of the system metrics table. The table aggregates data collected from various system sources, including `/proc/stat`, `/proc/net/dev`, `/proc/self/io`, and `/sys/class/hwmon`. Each row represents a snapshot of system metrics for a specific node at a given timestamp.

### Table Structure

| Column Name           | Data Type  | Description                                                                 |
|-----------------------|------------|-----------------------------------------------------------------------------|
| `timestamp`           | `datetime` | The timestamp of when the data was collected, including timezone information. |
| `node_id`             | `string`   | The identifier of the node (server) where the data was collected.           |
| `curr_max`            | `float`    | Maximum current (in amperes) measured across all sensors.                   |
| `power_max`           | `float`    | Maximum power (in watts) measured across all sensors.                       |
| `temp_max`            | `float`    | Maximum temperature (in degrees Celsius) measured across all sensors.       |
| `curr_mean`           | `float`    | Mean current (in amperes) measured across all sensors.                      |
| `power_mean`          | `float`    | Mean power (in watts) measured across all sensors.                          |
| `temp_mean`           | `float`    | Mean temperature (in degrees Celsius) measured across all sensors.          |
| `curr_median`         | `float`    | Median current (in amperes) measured across all sensors.                    |
| `power_median`        | `float`    | Median power (in watts) measured across all sensors.                        |
| `temp_median`         | `float`    | Median temperature (in degrees Celsius) measured across all sensors.        |
| `curr_min`            | `float`    | Minimum current (in amperes) measured across all sensors.                   |
| `power_min`           | `float`    | Minimum power (in watts) measured across all sensors.                       |
| `temp_min`            | `float`    | Minimum temperature (in degrees Celsius) measured across all sensors.       |
| `user`                | `integer`  | Time spent in user mode (in jiffies).                                       |
| `nice`                | `integer`  | Time spent in user mode with low priority (nice).                           |
| `system`              | `integer`  | Time spent in system mode (in jiffies).                                     |
| `idle`                | `integer`  | Time spent idle and not performing any task.                                               |
| `iowait`              | `integer`  | Time spent waiting for I/O operations to complete.                          |
| `irq`                 | `integer`  | Time spent servicing hardware interrupts.                                   |
| `softirq`             | `integer`  | Time spent servicing software interrupts.                                   |
| `steal`               | `integer`  | Time spent in other operating systems when running in a virtualized setup.  |
| `guest`               | `integer`  | Time spent running a virtual CPU for guest operating systems.               |
| `guest_nice`          | `integer`  | Time spent running a virtual CPU with low priority for guest systems.       |
| `rchar`               | `integer`  | Bytes read by the process (from `/proc/self/io`).                           |
| `wchar`               | `integer`  | Bytes written by the process (from `/proc/self/io`).                        |
| `syscr`               | `integer`  | Number of read system calls made by the process.                            |
| `syscw`               | `integer`  | Number of write system calls made by the process.                           |
| `read_bytes`          | `integer`  | Bytes read from storage devices.                                            |
| `write_bytes`         | `integer`  | Bytes written to storage devices.                                           |
| `cancelled_write_bytes` | `integer` | Bytes written but later discarded.                                          |
| `hsn0_rx_bytes`       | `float`    | Received bytes on the `hsn0` network interface.                             |
| `hsn1_rx_bytes`       | `float`    | Received bytes on the `hsn1` network interface.                             |
| `hsn2_rx_bytes`       | `float`    | Received bytes on the `hsn2` network interface.                             |
| `hsn3_rx_bytes`       | `float`    | Received bytes on the `hsn3` network interface.                             |
| `nmn0_rx_bytes`       | `float`    | Received bytes on the `nmn0` network interface.                             |
| `hsn0_rx_errors`      | `float`    | Receive errors on the `hsn0` network interface.                             |
| `hsn1_rx_errors`      | `float`    | Receive errors on the `hsn1` network interface.                             |
| `hsn2_rx_errors`      | `float`    | Receive errors on the `hsn2` network interface.                             |
| `hsn3_rx_errors`      | `float`    | Receive errors on the `hsn3` network interface.                             |
| `nmn0_rx_errors`      | `float`    | Receive errors on the `nmn0` network interface.                             |
| `hsn0_rx_packets`     | `float`    | Received packets on the `hsn0` network interface.                           |
| `hsn1_rx_packets`     | `float`    | Received packets on the `hsn1` network interface.                           |
| `hsn2_rx_packets`     | `float`    | Received packets on the `hsn2` network interface.                           |
| `hsn3_rx_packets`     | `float`    | Received packets on the `hsn3` network interface.                           |
| `nmn0_rx_packets`     | `float`    | Received packets on the `nmn0` network interface.                           |
| `hsn0_tx_bytes`       | `float`    | Transmitted bytes on the `hsn0` network interface.                          |
| `hsn1_tx_bytes`       | `float`    | Transmitted bytes on the `hsn1` network interface.                          |
| `hsn2_tx_bytes`       | `float`    | Transmitted bytes on the `hsn2` network interface.                          |
| `hsn3_tx_bytes`       | `float`    | Transmitted bytes on the `hsn3` network interface.                          |
| `nmn0_tx_bytes`       | `float`    | Transmitted bytes on the `nmn0` network interface.                          |
| `hsn0_tx_errors`      | `float`    | Transmit errors on the `hsn0` network interface.                            |
| `hsn1_tx_errors`      | `float`    | Transmit errors on the `hsn1` network interface.                            |
| `hsn2_tx_errors`      | `float`    | Transmit errors on the `hsn2` network interface.                            |
| `hsn3_tx_errors`      | `float`    | Transmit errors on the `hsn3` network interface.                            |
| `nmn0_tx_errors`      | `float`    | Transmit errors on the `nmn0` network interface.                            |
| `hsn0_tx_packets`     | `float`    | Transmitted packets on the `hsn0` network interface.                        |
| `hsn1_tx_packets`     | `float`    | Transmitted packets on the `hsn1` network interface.                        |
| `hsn2_tx_packets`     | `float`    | Transmitted packets on the `hsn2` network interface.                        |
| `hsn3_tx_packets`     | `float`    | Transmitted packets on the `hsn3` network interface.                        |
| `nmn0_tx_packets`     | `float`    | Transmitted packets on the `nmn0` network interface.                        |

### Notes

- **Units**:
  - Current (`curr_*`) is measured in amperes (A).
  - Power (`power_*`) is measured in watts (W).
  - Temperature (`temp_*`) is measured in degrees Celsius (°C).
  - Network metrics (e.g., `rx_bytes`, `tx_bytes`) are measured in bytes.
- **Sources**:
  - CPU metrics are derived from `/proc/stat`.
  - Network metrics are derived from `/proc/net/dev`.
  - I/O metrics are derived from `/proc/self/io`.
  - Temperature, power, and current metrics are derived from `/sys/class/hwmon`.

This table provides a comprehensive view of system performance, enabling detailed analysis of CPU, network, I/O, and hardware sensor data.